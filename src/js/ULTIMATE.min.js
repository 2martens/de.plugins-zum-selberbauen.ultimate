"use strict";(function(b,c){var a=b.fn.empty;b.fn.empty=function(){b(this).triggerHandler("empty");return a.call(b(this));};})(jQuery);(function(a,b){a.extend(a.ui.resizable,{_propagate:function(d,c){d.call(this,[c,this.ui()]);(d!="resize"&&this._trigger(d,c,this.ui()));}});});(function(a,b){a.getQueryData=function(d){if(d==""){return{};}var c={};for(var e=0;e<d.length;++e){var f=d[e].split("=");if(f.length!=2){continue;}c[f[0]]=decodeURIComponent(f[1].replace(/\+/g," "));}return c;};})(jQuery);(function(a,b){a.getLiveQueryData=a.getQueryData(window.location.search.substr(1).split("&"));})(jQuery);var ULTIMATE={};ULTIMATE.Action={};ULTIMATE.Action.Delete=WCF.Action.Delete.extend({_didTriggerEffect:function(a){var c=$(".counter").text();var b=c-1;$(".counter").text(b);},_initElements:function(){var a=this;$(this._containerSelector).each(function(c,b){var e=$(b);var d=e.wcfIdentify();e.find(a._buttonSelector).click($.proxy(a._click,a));if(!WCF.inArray(d,a._containers)){a._containers.push(d);}});}});ULTIMATE.Action.DeleteVersion=ULTIMATE.Action.Delete.extend({_sendRequest:function(a){this.proxy.setOption("data",{actionName:"deleteVersion",className:this._className,interfaceName:"wcf\\data\\IDeleteAction",objectIDs:[$(a).data("contentID")],parameters:{versionNumber:$(a).data("objectID")}});this.proxy.sendRequest();},_success:function(d,e,c){var a=d.returnValues;var b=+a.versionNumbers[0];this.triggerEffect([b]);}});ULTIMATE.Date={};ULTIMATE.Date.Picker={_dateFormat:"yy-mm-dd",_timeFormat:"g:ia",init:function(){var a=$.timepicker.log;$.timepicker.log=function(b){if(b.indexOf("Error parsing the date/time string: Unexpected literal at position")==-1){a(b);}};this._convertDateFormat();this._initDatePicker();WCF.DOMNodeInsertedHandler.addCallback("ULTIMATE.Date.Picker",$.proxy(this._initDatePicker,this));},_convertDateFormat:function(){var a={a:" tt",A:" TT",g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"l",d:"dd",D:"D",j:"d",l:"DD",z:"o",S:"",F:"MM",m:"mm",M:"M",n:"m",o:"yy",Y:"yy",y:"y",U:"@"};this._dateFormat=WCF.Language.get("wcf.date.dateFormat").replace(/([^dDjlzSFmMnoYyU\\]*(?:\\.[^dDjlzSFmMnoYyU\\]*)*)([dDjlzSFmMnoYyU])/g,function(c,f,e,g,b){for(var d in a){if(a.hasOwnProperty(d)&&e==d){e=a[d];}}return f+e;});this._timeFormat=WCF.Language.get("wcf.date.timeFormat").replace(/([^aAgGhHisu\\]*(?:\\.[^aAgGhHisu\\]*)*)([aAgGhHisu])/g,function(c,f,e,g,b){for(var d in a){if(a.hasOwnProperty(d)&&e==d){e=a[d];}}return f+e;});},_initDatePicker:function(){$("input[type=date]:not(.jsDatePicker)").each($.proxy(function(c,b){var e=$(b);var a=e.prop("name");var d=e.val();e.prop("type","text").addClass("jsDatePicker");if(e.data("placeholder")){e.attr("placeholder",e.data("placeholder"));}e.removeAttr("name");e.before('<input type="hidden" id="'+e.wcfIdentify()+'DatePicker" name="'+a+'" value="'+d+'" />');e.datepicker({altField:"#"+e.wcfIdentify()+"DatePicker",altFormat:"yy-mm-dd",beforeShow:function(g,f){setTimeout(function(){f.dpDiv.position({my:"left top",at:"left bottom",collision:"none",of:g});},1);},changeMonth:true,changeYear:true,dateFormat:this._dateFormat,dayNames:WCF.Language.get("__days"),dayNamesMin:WCF.Language.get("__daysShort"),dayNamesShort:WCF.Language.get("__daysShort"),monthNames:WCF.Language.get("__months"),monthNamesShort:WCF.Language.get("__monthsShort"),showOtherMonths:true,yearRange:(e.hasClass("birthday")?"-100:+0":"1900:2038"),onClose:function(g,f){if(g==""){$(f.settings.altField).val(g);}}});if(d){e.datepicker("setDate",new Date(d));}e.datepicker("widget").hide();},this));$("input[type=datetime]:not(.jsDatePicker)").each($.proxy(function(c,h){var g=$(h);var b=g.prop("name");var i=g.val();if(/[0-9]{2}:[0-9]{2}:[0-9]{2}$/.test(i)){i=i.replace(/:[0-9]{2}$/,"");g.val(i);}if(/^[0-9]{2}\.[0-9]{2}\.[0-9]{4}/.test(i)){var j=/[0-9]{4}/.exec(i);var e=j[0];j=/\.(0[1-9]|1[0-2])\./.exec(i);var d=j[1];j=/^[0-9]{2}/.exec(i);var f=j[0];j=/[0-9]{2}:[0-9]{2}$/.exec(i);var a=j[0];i=e+"-"+d+"-"+f+"T"+a+":00";}g.prop("type","text").addClass("jsDatePicker");g.removeAttr("name");g.before('<input type="hidden" id="'+g.wcfIdentify()+'DatePicker" name="'+b+'" value="'+i+'" />');g.datetimepicker({altField:"#"+g.wcfIdentify()+"DatePicker",altFieldTimeOnly:false,altFormat:"yy-mm-dd",altTimeFormat:"HH:mm",beforeShow:function(l,k){setTimeout(function(){k.dpDiv.position({my:"left top",at:"left bottom",collision:"none",of:l});},1);},changeMonth:true,changeYear:true,controlType:"select",dateFormat:this._dateFormat,dayNames:WCF.Language.get("__days"),dayNamesMin:WCF.Language.get("__daysShort"),dayNamesShort:WCF.Language.get("__daysShort"),hourText:WCF.Language.get("wcf.date.hour"),minuteText:WCF.Language.get("wcf.date.minute"),monthNames:WCF.Language.get("__months"),monthNamesShort:WCF.Language.get("__monthsShort"),showButtonPanel:false,showTime:false,showOtherMonths:true,timeFormat:this._timeFormat,yearRange:(g.hasClass("birthday")?"-100:+0":"1900:2038"),onClose:function(l,k){if(l==""){$(k.settings.altField).val("");}}});if(i){g.removeClass("hasDatepicker").datetimepicker("setDate",new Date(i));}g.datepicker("widget").hide();},this));}};ULTIMATE.JSON={init:function(){},encode:function(c){var e=typeof c;var d=this;if(c instanceof Array){var a="[";var b=0;var f=c.length;$.each(c,function(g,h){if(b>0&&b<f){a+=",";}if(h instanceof Array||typeof h=="object"){a+=d.encode(h);}a+='"'+h+'"';b++;});a+="]";return a;}else{if(e=="object"){var a="{";var b=0;var f=$.getLength(c);$.each(c,function(g,h){if(b>0&&b<f){a+=",";}a+='"'+g+'":';var i=typeof h;if(h instanceof Array){a+=d.encode(h);}else{if(i=="object"){a+=d.encode(h);}else{if(i=="string"){a+='"'+h+'"';}}}b++;});a+="}";return a;}}return null;}};ULTIMATE.MultipleLanguageWYSIWYG=WCF.MultipleLanguageInput.extend({_element:null,_box:null,_disableCalled:false,init:function(c,b,d,f){this._button=null;this._element=$("#"+$.wcfEscapeID(c));this._box=this._element.redactor("core.getBox");this._forceSelection=b;this._values=d;this._availableLanguages=f;if($.getLength(this._values)){for(var e in this._values){if(this._values.hasOwnProperty(e)){this._values[e]=WCF.String.unescapeHTML(this._values[e]);}}}this._languageID=LANGUAGE_ID;if(this._element.length==0){console.debug("[WCF.MultipleLanguageInput] element id '"+c+"' is unknown");return;}var a=($.getLength(this._values)>0);this._insertedDataAfterInit=a;this._prepareElement(a);this._element.parents("form").submit($.proxy(this._submit,this));this._didInit=true;},_prepareElement:function(a){this._box.wrap('<div class="dropdown preInput" />');var c=this._box.parent();this._button=$('<p class="button dropdownToggle"><span>'+WCF.Language.get("wcf.global.button.disabledI18n")+"</span></p>").prependTo(c);this._list=$('<ul class="dropdownMenu"></ul>').insertAfter(this._button);this._button.addClass("dropdownCaptionTextarea");for(var b in this._availableLanguages){if(this._availableLanguages.hasOwnProperty(b)){$("<li><span>"+this._availableLanguages[b]+"</span></li>").data("languageID",b).click($.proxy(this._changeLanguage,this)).appendTo(this._list);}}if(!this._forceSelection){$('<li class="dropdownDivider" />').appendTo(this._list);$("<li><span>"+WCF.Language.get("wcf.global.button.disabledI18n")+"</span></li>").click($.proxy(this._disable,this)).appendTo(this._list);}WCF.Dropdown.initDropdown(this._button,a);if(a||this._forceSelection){this._isEnabled=true;this._list.children("li").each($.proxy(function(d,f){var e=$(f);if(e.data("languageID")==this._languageID){e.trigger("click");}},this));}WCF.Dropdown.registerCallback(c.wcfIdentify(),$.proxy(this._handleAction,this));},_changeLanguage:function(a){var b=$(a.currentTarget);this._insertedDataAfterInit=true;if(this._disableCalled){this._disableCalled=false;}if(this._didInit){this._values[this._languageID]=this._element.redactor("wutil.getText");}this._languageID=b.data("languageID");if(this._values[this._languageID]){this._element.redactor("wutil.replaceText",this._values[this._languageID]);}else{this._element.redactor("wutil.reset");}this._list.children("li").removeClass("active");b.addClass("active");this._button.children("span").addClass("active").text(this._availableLanguages[this._languageID]);if(this._didInit){}},_disable:function(a){if(a===undefined&&this._insertedDataAfterInit){a=null;}if(this._forceSelection||!this._list||a===null||this._disableCalled){return;}this._disableCalled=true;this._button.children("span").removeClass("active").text(WCF.Language.get("wcf.global.button.disabledI18n"));if(this._values[window.LANGUAGE_ID]){this._element.redactor("wutil.replaceText",this._values[window.LANGUAGE_ID]);}else{this._element.redactor("wutil.reset");}this._languageID=window.LANGUAGE_ID;if(a){this._list.children("li").removeClass("active");$(a.currentTarget).addClass("active");}this._insertedDataAfterInit=false;this._isEnabled=false;this._values={};},_submit:function(){if(!this._isEnabled){return 3735928559;}if(this._languageID){this._values[this._languageID]=this._element.redactor("wutil.getText");}var b=$(this._element.parents("form")[0]);var c=this._element.wcfIdentify();for(var a in this._availableLanguages){if(this._availableLanguages.hasOwnProperty(a)&&this._values[a]===undefined){this._values[a]="";}$('<input type="hidden" name="'+c+"_i18n["+a+']" value="'+WCF.String.escapeHTML(this._values[a])+'" />').appendTo(b);}this._element.removeAttr("name");}});ULTIMATE.Permission={_variables:new WCF.Dictionary(),add:function(a,b){this._variables.add(a,b);},addObject:function(a){this._variables.addObject(a);},get:function(a){var b=this._variables.get(a);if(b===null){return a;}return b;}};ULTIMATE.NestedSortable={};ULTIMATE.NestedSortable.Delete=WCF.Action.Delete.extend({triggerEffect:function(c){for(var a in this._containers){if(this._containers.hasOwnProperty(a)){var d=$("#"+this._containers[a]);if(WCF.inArray(d.find(".jsDeleteButton").data("objectID"),c)){if(d.has("ol").has("li")){var b=d.find("> ol");d.before(b.contents());b.contents().detach();d.remove();}else{d.wcfBlindOut("up",function(){d.remove();});}}}}}});